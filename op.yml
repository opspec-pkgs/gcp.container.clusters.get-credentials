name: github.com/opspec-pkgs/gcp.gke.get-kubeconfig
description: |
  gets a kubeconfig for a kubernetes cluster in google kubernetes engine service
  > note: auth in the returned file will be valid for 1hr
inputs:
  clusterName:
    string:
      description: name of gke cluster
  keyFile:
    file:
      description: key file for a GCP service account w/ `Kubernetes Engine Developer` role
      isSecret: true
  projectId:
    string:
      description: id of the GCP project containing the gke cluster
  zone:
    string:
      description: zone of the gke cluster
outputs:
  kubeConfig:
    file:
      description: the kube config
opspec: 0.1.6
version: 1.2.0
run:
  container:
    image: { ref: 'opspecpkgs/gcp.gke.get-kubeconfig:1.2.0' }
    files:
      /cmd.sh:
      /keyFile: $(keyFile)
      /kubeConfig: $(kubeConfig)
    cmd: [ /cmd.sh ]
    envVars:
      clusterName:
      projectId:
      zone: